{"version":3,"sources":["app/app.js","node_modules/auto-reload-brunch/vendor/auto-reload.js"],"names":["$","fetchUnpublishedCaches","button","ajax","done","data","prop","hide","success","alert","message","show","html","each","geocaches","index","g","append","referenceCode","geocacheType","imageUrl","name","url","count","fail","jqXHR","textStatus","errorThrown","console","error","click","is","on","countFrom","parseInt","parents","countTo","val","change","geocodes","create","push","value","length","removeClass","gpxSplit","type","link","always","ready","user","WebSocket","window","MozWebSocket","br","brunch","ar","disabled","_ar","cacheBuster","date","Math","round","Date","now","toString","replace","indexOf","browser","navigator","userAgent","toLowerCase","forceRepaint","reloaders","page","location","reload","stylesheet","slice","call","document","querySelectorAll","filter","getAttribute","href","forEach","setTimeout","body","offsetHeight","javascript","scripts","textScripts","map","script","text","srcScripts","src","loaded","all","onLoad","eval","remove","newScript","createElement","async","onload","head","appendChild","port","host","server","hostname","connect","connection","onmessage","event","reloader","onerror","readyState","close","onclose"],"mappings":"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","file":"web/assets/app.min.js","sourcesContent":["(function ($) {\n  \"use strict\";\n\n  let fetchUnpublishedCaches = function () {\n    // $('#refresh-cache').button('loading');\n    $(\"#create-gpx\").button(\"reset\");\n\n    $.ajax(\"unpublished.php\")\n      .done(function(data) {\n        $(\"#select-all\").prop(\"checked\", false);\n        $(\"#fetching-unpublished-caches\").hide();\n        // $('#refresh-cache').button('reset');\n        if (!data || data === \"\" || typeof data !== \"object\") {\n            // console.error(data);\n            return false;\n        }\n        if (data && !data.success) {\n            alert(data.message);\n            // console.error(data.message);\n        } else {\n            $(\"#table-unpublished-caches\").show();\n            $(\"#table-caches tbody\").html(\"\");\n\n            $.each(data.geocaches, function(index, g) {\n                $(\"#table-caches tbody\")\n                    .append(`\n                    <tr class=\"${g.referenceCode}\" data-counter=\" ${index+1}\" title=\"Add this geocache to the GPX\">\n                            <td style=\"text-align: center;\"><input type=\"checkbox\" name=\"cache\" class=\"unpublished-geocache\" value=\"${g.referenceCode }\" id=\"${g.referenceCode}\" /></td>\n                            <td>#${index+1}</td>\n                            <td>${g.referenceCode}</td>\n                            <td><label for=\"${g.referenceCode}\"><img src=\"${g.geocacheType.imageUrl}\" alt=\"${g.geocacheType.name}\" width=\"24\" /> ${g.name}</label></td>\n                            <td class=\"link\"><a href=\"${g.url}\" title=\"View on geocaching.com\"><span class=\"glyphicon glyphicon-new-window\"></span></a></td>\n                        </tr>`);\n            });\n            $(\"#totalGeocaches\").html(\"(\" + data.count + \")\");\n\n            $(\"#table-caches tbody\").show();\n        }\n      })\n      .fail(function(jqXHR, textStatus, errorThrown) {\n        alert(textStatus);\n        console.error(jqXHR, textStatus, errorThrown);\n      });\n  };\n\n  $(\"#select-all\").click(function () {\n    $(\".unpublished-geocache\").prop(\"checked\", $(this).is(\":checked\"));\n  });\n\n  $(\"#table-caches tbody\").on(\"click\", \"input[type=checkbox]\", function () {\n    if ($(\"#chk_select\").prop(\"checked\") && $(this).prop(\"checked\")) {\n      var countFrom = parseInt($(this).parents(\"tr\").data(\"counter\"), 10);\n\n      var countTo = parseInt($(\"#block_select input[type=range]\").val(), 10) - 1;\n      $(\"#table-caches tbody tr:nth-child(n+\" + (countFrom + 1) + \"):nth-child(-n+\" + (countFrom + countTo) + \") input[type=checkbox]\").prop(\"checked\", true);\n    }\n  });\n  // $('#refresh-cache').click(function() {\n  //     $('#table-caches tbody').slideUp(400, fetchUnpublishedCaches);\n  // });\n\n  $(\"#chk_split\").change(function () {\n    $(\"#block_split input[type=range]\").prop(\"disabled\", !$(this).prop(\"checked\"));\n  });\n\n  $(\"#block_split input[type=range]\").change(function () {\n    $(\"label[for=chk_split]\").html(\"Split GPX files by \" + $(this).val() + \" geocaches\");\n  });\n\n  $(\"#chk_select\").change(function () {\n    $(\"#block_select input[type=range]\").prop(\"disabled\", !$(this).prop(\"checked\"));\n  });\n\n  $(\"#block_select input[type=range]\").change(function () {\n    $(\"label[for=chk_select]\").html(\"Pick \" + $(this).val() + \" geocaches\");\n  });\n\n  $(\"#create-gpx\").click(function () {\n    let geocodes = [];\n\n    let create = $(this);\n\n    $(\"input[name=cache]:checked\").each(function () {\n      geocodes.push(this.value);\n    });\n\n    if (geocodes.length <= 0) {\n      alert(\"You must choose at least one cache.\");\n      return false;\n    }\n\n    $(\"#download-links\").html(\"\");\n    $(\"#table-caches tbody tr\").removeClass(\"success\");\n    $(\"#table-caches tbody tr\").removeClass(\"danger\");\n    $(\"#table-caches .status\").html(\"\");\n\n    create.button(\"loading\");\n\n    let gpxSplit = $(\"#chk_split\").prop(\"checked\") ? +$(\"#block_split input[type=range]\").val() : 0;\n\n    $.ajax({\n      url: \"geocaches.php\",\n      type: \"POST\",\n      data: {\n        \"geocodes\": geocodes,\n        \"gpxSplit\": gpxSplit\n      }\n    }).done(function (data) {\n      if (data && data.success) {\n        // console.log(data.fail);\n        $(\"#download-links\").append(data.link);\n      } else {\n        alert(data.message);\n        // console.error(data.message);\n      }\n    }).fail(function (jqXHR, textStatus) {\n      alert(textStatus);\n      // console.error(textStatus);\n    }).always(function () {\n      create.button(\"reset\");\n    });\n  });\n\n  $().ready(function() {\n    if (user) {\n      $(\"#fetching-unpublished-caches\").show(0, fetchUnpublishedCaches);\n    }\n  });\n\n}($));\n","/* jshint ignore:start */\n(function() {\n  var WebSocket = window.WebSocket || window.MozWebSocket;\n  var br = window.brunch = (window.brunch || {});\n  var ar = br['auto-reload'] = (br['auto-reload'] || {});\n  if (!WebSocket || ar.disabled) return;\n  if (window._ar) return;\n  window._ar = true;\n\n  var cacheBuster = function(url){\n    var date = Math.round(Date.now() / 1000).toString();\n    url = url.replace(/(\\&|\\\\?)cacheBuster=\\d*/, '');\n    return url + (url.indexOf('?') >= 0 ? '&' : '?') +'cacheBuster=' + date;\n  };\n\n  var browser = navigator.userAgent.toLowerCase();\n  var forceRepaint = ar.forceRepaint || browser.indexOf('chrome') > -1;\n\n  var reloaders = {\n    page: function(){\n      window.location.reload(true);\n    },\n\n    stylesheet: function(){\n      [].slice\n        .call(document.querySelectorAll('link[rel=stylesheet]'))\n        .filter(function(link) {\n          var val = link.getAttribute('data-autoreload');\n          return link.href && val != 'false';\n        })\n        .forEach(function(link) {\n          link.href = cacheBuster(link.href);\n        });\n\n      // Hack to force page repaint after 25ms.\n      if (forceRepaint) setTimeout(function() { document.body.offsetHeight; }, 25);\n    },\n\n    javascript: function(){\n      var scripts = [].slice.call(document.querySelectorAll('script'));\n      var textScripts = scripts.map(function(script) { return script.text }).filter(function(text) { return text.length > 0 });\n      var srcScripts = scripts.filter(function(script) { return script.src });\n\n      var loaded = 0;\n      var all = srcScripts.length;\n      var onLoad = function() {\n        loaded = loaded + 1;\n        if (loaded === all) {\n          textScripts.forEach(function(script) { eval(script); });\n        }\n      }\n\n      srcScripts\n        .forEach(function(script) {\n          var src = script.src;\n          script.remove();\n          var newScript = document.createElement('script');\n          newScript.src = cacheBuster(src);\n          newScript.async = true;\n          newScript.onload = onLoad;\n          document.head.appendChild(newScript);\n        });\n    }\n  };\n  var port = ar.port || 9485;\n  var host = br.server || window.location.hostname || 'localhost';\n\n  var connect = function(){\n    var connection = new WebSocket('ws://' + host + ':' + port);\n    connection.onmessage = function(event){\n      if (ar.disabled) return;\n      var message = event.data;\n      var reloader = reloaders[message] || reloaders.page;\n      reloader();\n    };\n    connection.onerror = function(){\n      if (connection.readyState) connection.close();\n    };\n    connection.onclose = function(){\n      window.setTimeout(connect, 1000);\n    };\n  };\n  connect();\n})();\n/* jshint ignore:end */\n"]}